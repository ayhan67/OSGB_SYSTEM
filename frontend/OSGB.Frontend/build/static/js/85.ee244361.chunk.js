"use strict";(self.webpackChunkosgb_frontend=self.webpackChunkosgb_frontend||[]).push([[85],{85:(e,s,a)=>{a.r(s),a.d(s,{default:()=>o});var n=a(555),l=a(43),i=a(291),t=a(216),r=a(240),d=a(579);const o=()=>{const[e,s]=(0,l.useState)({firstName:"",lastName:"",phone:"",assignedMinutes:11900}),[a,o]=(0,l.useState)([]),[c,m]=(0,l.useState)(""),[h,u]=(0,l.useState)(""),x=e=>/^[a-zA-Z\u011f\xfc\u015f\u0131\xf6\xe7\u011e\xdc\u015e\u0130\xd6\xc7\s]+$/.test(e),p=e=>/^5\d{2}\s\d{3}\s\d{2}\s\d{2}$/.test(e),N=e=>{const s=e.replace(/\D/g,"").substring(0,10);let a="";for(let n=0;n<s.length;n++)3!==n&&6!==n&&8!==n||(a+=" "),a+=s[n];return a},j=((0,t.Zp)(),(0,t.zy)());(0,l.useEffect)(()=>{f()},[]),(0,l.useEffect)(()=>{console.log("DoctorCardPage: Location changed to:",j.pathname,"at:",(new Date).toISOString()),f()},[j.pathname]),(0,l.useEffect)(()=>{const e=()=>{console.log("DoctorCardPage: Window focused, refreshing doctors..."),f()};return window.addEventListener("focus",e),()=>{window.removeEventListener("focus",e)}},[]),(0,l.useEffect)(()=>{const e=()=>{console.log("DoctorCardPage: Workplace created, refreshing doctors..."),f()};return window.addEventListener("workplaceCreated",e),()=>{window.removeEventListener("workplaceCreated",e)}},[]);const f=async()=>{try{const e=await(0,i.ar)();o(e)}catch(e){console.error("Hekimler getirilirken hata olu\u015ftu:",e)}},g=(()=>{const e={totalCount:a.length,totalMinutes:0,usedMinutes:0,remainingMinutes:0};return a.forEach(s=>{e.totalMinutes+=s.assignedMinutes||0,e.usedMinutes+=s.usedMinutes||0,e.remainingMinutes+=(s.assignedMinutes||0)-(s.usedMinutes||0)}),e})(),v=e=>{const{name:a,value:l}=e.target;if("firstName"===a||"lastName"===a){const e=l.replace(/\d/g,"");s(s=>(0,n.A)((0,n.A)({},s),{},{[a]:e}))}else if("phone"===a){const e=N(l);s(s=>(0,n.A)((0,n.A)({},s),{},{[a]:e}))}else s(e=>(0,n.A)((0,n.A)({},e),{},{[a]:"assignedMinutes"===a?""===l?0:parseInt(l)||0:l}))},b=()=>{setTimeout(()=>{m(""),u("")},3e3)},y=()=>{S(!1),w(null),A(!1)},[k,w]=(0,l.useState)(null),[C,S]=(0,l.useState)(!1),[M,A]=(0,l.useState)(!1),[T,D]=(0,l.useState)({firstName:"",lastName:"",phone:"",assignedMinutes:11900}),H=e=>{const{name:s,value:a}=e.target;if("firstName"===s||"lastName"===s){const e=a.replace(/\d/g,"");D(a=>(0,n.A)((0,n.A)({},a),{},{[s]:e}))}else if("phone"===s){const e=N(a);D(a=>(0,n.A)((0,n.A)({},a),{},{[s]:e}))}else D(e=>(0,n.A)((0,n.A)({},e),{},{[s]:"assignedMinutes"===s?""===a?0:parseInt(a)||0:a}))},z=e=>{(async e=>{try{const s=await(0,i.HR)(e.id);q(s),O(e)}catch(h){console.error("Error fetching assigned workplaces:",h),q([])}w(e),A(!1),S(!0)})(e)},[E,K]=(0,l.useState)(!1),[L,q]=(0,l.useState)([]),[I,O]=(0,l.useState)(null);return(0,d.jsxs)("div",{className:"doctor-card-page",children:[c&&(0,d.jsx)("div",{className:"popup-notification alert alert-info",children:c}),h&&(0,d.jsx)("div",{className:"popup-notification alert alert-warning",children:h}),(0,d.jsx)("div",{className:"draggable-card",style:{position:"absolute",left:65,top:10,width:375,height:320,zIndex:100},children:(0,d.jsxs)("div",{className:"window",style:{width:"100%",height:"100%",display:"flex",flexDirection:"column"},children:[(0,d.jsx)("div",{className:"window-header",style:{userSelect:"none"},children:(0,d.jsx)("span",{children:"Yeni Hekim Kay\u0131t"})}),(0,d.jsx)("div",{className:"window-content",style:{flex:1,overflow:"visible"},children:(0,d.jsxs)("form",{onSubmit:async a=>{if(a.preventDefault(),u(""),m(""),!x(e.firstName))return u("Ad sadece harf i\xe7ermelidir"),void b();if(!x(e.lastName))return u("Soyad sadece harf i\xe7ermelidir"),void b();if(!p(e.phone))return u("Telefon numaras\u0131 5xx xxx xx xx format\u0131nda olmal\u0131d\u0131r"),void b();if(e.assignedMinutes>11900)return u("Atanan dakika 11.900'\xfc ge\xe7emez"),void b();try{await(0,i.Qg)(e),m("Hekim ba\u015far\u0131yla kaydedildi!"),s({firstName:"",lastName:"",phone:"",assignedMinutes:11900}),f(),b()}catch(n){console.error("Create doctor error:",n);const e=n.message||"Hekim kaydedilirken hata olu\u015ftu";u(e),b()}},className:"registration-form",children:[(0,d.jsxs)("div",{className:"form-row",children:[(0,d.jsx)("div",{className:"form-col",children:(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{className:"form-label",children:"Ad:"}),(0,d.jsx)("input",{type:"text",name:"firstName",className:"form-input",value:e.firstName,onChange:v,required:!0})]})}),(0,d.jsx)("div",{className:"form-col",children:(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{className:"form-label",children:"Soyad:"}),(0,d.jsx)("input",{type:"text",name:"lastName",className:"form-input",value:e.lastName,onChange:v,required:!0})]})})]}),(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{className:"form-label",children:"Telefon:"}),(0,d.jsx)("input",{type:"text",name:"phone",className:"form-input",value:e.phone,onChange:v,placeholder:"5xx xxx xx xx",required:!0})]}),(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{className:"form-label",children:"Atanan Dakika:"}),(0,d.jsx)("input",{type:"number",name:"assignedMinutes",className:"form-input",value:e.assignedMinutes,onChange:v,min:"0",max:"11900",required:!0})]}),(0,d.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Hekim Kaydet"})]})})]})}),(0,d.jsx)("div",{className:"draggable-card",style:{position:"absolute",right:70,top:10,width:300,height:400,zIndex:100},children:(0,d.jsxs)("div",{className:"window",style:{width:"100%",height:"100%",display:"flex",flexDirection:"column"},children:[(0,d.jsx)("div",{className:"window-header",style:{userSelect:"none"},children:(0,d.jsx)("span",{children:"Hekim \u0130statistikleri"})}),(0,d.jsx)("div",{className:"window-content",style:{flex:1,overflow:"visible",padding:"15px"},children:(0,d.jsxs)("div",{className:"stats-container",children:[(0,d.jsxs)("div",{className:"stats-section",children:[(0,d.jsx)("h3",{children:"Kay\u0131tl\u0131 Hekim Say\u0131s\u0131"}),(0,d.jsxs)("div",{className:"stat-item",children:[(0,d.jsx)("span",{className:"stat-label",children:"Toplam:"}),(0,d.jsx)("span",{className:"stat-value",children:g.totalCount})]})]}),(0,d.jsxs)("div",{className:"stats-section",children:[(0,d.jsx)("h3",{children:"Tan\u0131mlanan Dakikalar"}),(0,d.jsxs)("div",{className:"stat-item",children:[(0,d.jsx)("span",{className:"stat-label",children:"Toplam:"}),(0,d.jsx)("span",{className:"stat-value",children:g.totalMinutes})]})]}),(0,d.jsxs)("div",{className:"stats-section",children:[(0,d.jsx)("h3",{children:"Kullan\u0131lan Dakikalar"}),(0,d.jsxs)("div",{className:"stat-item",children:[(0,d.jsx)("span",{className:"stat-label",children:"Toplam:"}),(0,d.jsx)("span",{className:"stat-value",children:g.usedMinutes})]})]}),(0,d.jsxs)("div",{className:"stats-section",children:[(0,d.jsx)("h3",{children:"Kalan Dakikalar"}),(0,d.jsxs)("div",{className:"stat-item",children:[(0,d.jsx)("span",{className:"stat-label",children:"Toplam:"}),(0,d.jsx)("span",{className:"stat-value",children:g.remainingMinutes})]})]})]})})]})}),(0,d.jsx)("div",{className:"registered-doctors-container",style:{position:"absolute",right:"70px",top:"100px",width:"400px"},children:a.map(e=>(0,d.jsxs)("div",{onClick:()=>z(e),style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px",margin:"10px 0",borderRadius:"8px",cursor:"pointer",transition:"all 0.3s ease",position:"relative",top:"-100px",left:"-400px",width:"100%",backgroundColor:"#bbdefb"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="#90caf9",e.currentTarget.style.boxShadow="0 4px 8px rgba(33, 150, 243, 0.3)",e.currentTarget.style.transform="translateY(-2px)"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="#bbdefb",e.currentTarget.style.boxShadow="none",e.currentTarget.style.transform="translateY(0)"},children:[(0,d.jsxs)("div",{className:"doctor-info-display",style:{fontSize:"15px"},children:[(0,d.jsxs)("div",{className:"doctor-name-display",children:[e.firstName," ",e.lastName]}),(0,d.jsx)("div",{className:"doctor-phone-display",children:e.phone})]}),(0,d.jsx)("div",{className:"doctor-class-display",style:{backgroundColor:"#1976d2",color:"white"},children:"H"})]},e.id))}),C&&k&&(0,d.jsx)("div",{className:"modal-overlay",onClick:e=>{e.target===e.currentTarget&&y()},children:(0,d.jsx)("div",{className:"modal-content draggable-card",onClick:e=>e.stopPropagation(),style:{width:400,height:500,maxWidth:"90vw",maxHeight:"90vh",position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",margin:0,zIndex:2001},children:(0,d.jsxs)("div",{className:"window",style:{width:"100%",height:"100%",display:"flex",flexDirection:"column"},children:[(0,d.jsxs)("div",{className:"window-header",style:{userSelect:"none"},children:[(0,d.jsx)("span",{children:M?"Hekim D\xfczenle":"Hekim Detaylar\u0131"}),(0,d.jsx)("div",{className:"window-controls",children:(0,d.jsx)("button",{className:"window-button",onClick:y,children:"\xd7"})})]}),(0,d.jsx)("div",{className:"window-content",children:M?(0,d.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),k){if(!x(T.firstName))return u("Ad sadece harf i\xe7ermelidir"),void b();if(!x(T.lastName))return u("Soyad sadece harf i\xe7ermelidir"),void b();if(!p(T.phone))return u("Telefon numaras\u0131 5xx xxx xx xx format\u0131nda olmal\u0131d\u0131r"),void b();if(T.assignedMinutes>11900)return u("Atanan dakika 11.900'\xfc ge\xe7emez"),void b();try{await(0,i.Nf)(k.id,T),m("Hekim ba\u015far\u0131yla g\xfcncellendi!"),y(),f(),b()}catch(s){console.error("Update error:",s);const e=s.message||"Hekim g\xfcncellenirken hata olu\u015ftu";u(e),b()}}},className:"edit-form",children:[(0,d.jsxs)("div",{className:"form-row",children:[(0,d.jsx)("div",{className:"form-col",children:(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{className:"form-label",children:"Ad:"}),(0,d.jsx)("input",{type:"text",name:"firstName",className:"form-input",value:T.firstName,onChange:H,required:!0})]})}),(0,d.jsx)("div",{className:"form-col",children:(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{className:"form-label",children:"Soyad:"}),(0,d.jsx)("input",{type:"text",name:"lastName",className:"form-input",value:T.lastName,onChange:H,required:!0})]})})]}),(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{className:"form-label",children:"Telefon:"}),(0,d.jsx)("input",{type:"text",name:"phone",className:"form-input",value:T.phone,onChange:H,placeholder:"5xx xxx xx xx",required:!0})]}),(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("label",{className:"form-label",children:"Atanan Dakika:"}),(0,d.jsx)("input",{type:"number",name:"assignedMinutes",className:"form-input",value:T.assignedMinutes,onChange:H,min:"0",max:"11900",required:!0})]}),(0,d.jsxs)("div",{className:"modal-actions",children:[(0,d.jsx)("button",{type:"submit",className:"btn btn-primary",children:"G\xfcncelle"}),(0,d.jsx)("button",{type:"button",className:"btn",onClick:y,children:"\u0130ptal"})]})]}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:"doctor-detail-info",children:[(0,d.jsxs)("div",{className:"doctor-detail-row",children:[(0,d.jsx)("strong",{children:"Ad:"})," ",k.firstName]}),(0,d.jsxs)("div",{className:"doctor-detail-row",children:[(0,d.jsx)("strong",{children:"Soyad:"})," ",k.lastName]}),(0,d.jsxs)("div",{className:"doctor-detail-row",children:[(0,d.jsx)("strong",{children:"Telefon:"})," ",k.phone]}),(0,d.jsxs)("div",{className:"doctor-detail-row",children:[(0,d.jsx)("strong",{children:"Toplam Dakika:"})," ",k.assignedMinutes]}),(0,d.jsxs)("div",{className:"doctor-detail-row",children:[(0,d.jsx)("strong",{children:"Atanan Dakika:"})," ",k.usedMinutes||0]}),(0,d.jsxs)("div",{className:"doctor-detail-row",children:[(0,d.jsx)("strong",{children:"Kalan Dakika:"})," ",k.assignedMinutes-(k.usedMinutes||0)]}),(0,d.jsxs)("div",{className:"doctor-detail-row",children:[(0,d.jsx)("strong",{children:"Atand\u0131\u011f\u0131 \u0130\u015f Yeri:"}),L.length>0?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("span",{children:"atand\u0131"}),(0,d.jsx)("button",{className:"btn btn-primary",style:{marginTop:"22px",marginLeft:"10px",padding:"1px 14px",fontSize:"15px"},onClick:()=>K(!0),children:"g\xf6r"})]}):(0,d.jsx)("span",{children:"Atanmam\u0131\u015f"})]})]}),(0,d.jsxs)("div",{className:"modal-actions",children:[(0,d.jsx)("button",{className:"btn btn-primary",onClick:()=>{return w(e=k),D({firstName:e.firstName||"",lastName:e.lastName||"",phone:e.phone||"",assignedMinutes:e.assignedMinutes||11900}),A(!0),void S(!0);var e},children:"D\xfczenle"}),(0,d.jsx)("button",{className:"btn btn-danger",onClick:()=>{window.confirm("Bu hekim kayd\u0131n\u0131 silmek istedi\u011finize emin misiniz?")&&(async e=>{if(window.confirm("Bu hekim kayd\u0131n\u0131 silmek istedi\u011finize emin misiniz?"))try{await(0,i.Hr)(e),m("Hekim ba\u015far\u0131yla silindi!"),f(),k&&k.id===e&&(S(!1),w(null)),b()}catch(s){console.error("Delete error:",s);const e=s.message||"Hekim silinirken hata olu\u015ftu";u(e),b()}})(k.id)},children:"Sil"}),(0,d.jsx)("button",{className:"btn btn-close",onClick:y,children:"Kapat"})]})]})})]})})}),(0,d.jsx)(r.A,{isOpen:E,onClose:()=>{K(!1),O(null)},workplaces:L,personnelName:I?"".concat(I.firstName," ").concat(I.lastName):"",personnelType:"Hekim"})]})}},240:(e,s,a)=>{a.d(s,{A:()=>l});a(43);var n=a(579);const l=e=>{let{isOpen:s,onClose:a,workplaces:l,personnelName:i,personnelType:t}=e;if(!s)return null;const r=e=>{switch(e){case"low":return"Az Tehlikeli";case"dangerous":return"Tehlikeli";case"veryDangerous":return"\xc7ok Tehlikeli";default:return"Belirtilmemi\u015f"}},d=e=>{if(!e)return"";return new Date(e).toLocaleDateString("tr-TR")};return(0,n.jsx)("div",{className:"modal-overlay",onClick:a,children:(0,n.jsx)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:(0,n.jsxs)("div",{className:"window",children:[(0,n.jsxs)("div",{className:"window-header",children:[(0,n.jsxs)("span",{children:[i," - Atand\u0131\u011f\u0131 \u0130\u015f Yerleri"]}),(0,n.jsx)("button",{className:"window-button",onClick:a,children:"\xd7"})]}),(0,n.jsx)("div",{className:"window-content",style:{padding:0,margin:0},children:0===l.length?(0,n.jsx)("p",{children:"Hen\xfcz atanm\u0131\u015f i\u015f yeri bulunmamaktad\u0131r."}):(0,n.jsxs)("div",{className:"workplaces-table",children:[(0,n.jsxs)("div",{className:"table-header",children:[(0,n.jsx)("div",{className:"table-cell",children:"\u0130\u015f Yeri Ad\u0131"}),(0,n.jsx)("div",{className:"table-cell",children:"SGK Sicil No"}),(0,n.jsx)("div",{className:"table-cell",children:"Tehlike S\u0131n\u0131f\u0131"}),(0,n.jsx)("div",{className:"table-cell",children:"\xc7al\u0131\u015fan Say\u0131s\u0131"}),(0,n.jsx)("div",{className:"table-cell",children:"Kay\u0131t Tarihi"}),(0,n.jsx)("div",{className:"table-cell",children:"Onay Durumu"})]}),l.map(e=>(0,n.jsxs)("div",{className:"table-row",children:[(0,n.jsx)("div",{className:"table-cell",title:e.name,children:e.name}),(0,n.jsx)("div",{className:"table-cell",title:e.sskRegistrationNo,children:e.sskRegistrationNo}),(0,n.jsx)("div",{className:"table-cell",children:r(e.riskLevel)}),(0,n.jsx)("div",{className:"table-cell",children:e.employeeCount}),(0,n.jsx)("div",{className:"table-cell",children:d(e.registrationDate)}),(0,n.jsx)("div",{className:"table-cell",children:(0,n.jsxs)("span",{className:"status-badge status-".concat(e.approvalStatus),children:["atama"===e.approvalStatus&&"Atama yap\u0131lacak","bekliyor"===e.approvalStatus&&"Onay bekleniyor","onaylandi"===e.approvalStatus&&"Onayland\u0131"]})})]},e.id))]})}),(0,n.jsx)("div",{className:"modal-actions",style:{padding:"15px",margin:0},children:(0,n.jsx)("button",{className:"btn btn-close",onClick:a,children:"Kapat"})})]})})})}}}]);
//# sourceMappingURL=85.ee244361.chunk.js.map