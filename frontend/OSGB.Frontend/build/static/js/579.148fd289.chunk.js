"use strict";(self.webpackChunkosgb_frontend=self.webpackChunkosgb_frontend||[]).push([[579],{960:(e,a,s)=>{s.r(a),s.d(a,{default:()=>r});var l=s(555),n=s(43),i=s(216),t=s(291),c=s(579);const r=()=>{console.log("WorkplacePage component rendered at:",(new Date).toISOString());const e=(0,i.zy)(),[a,s]=(0,n.useState)([]),[r,o]=(0,n.useState)([]),[d,m]=(0,n.useState)([]),[h,p]=(0,n.useState)([]),[u,N]=(0,n.useState)(""),[x,f]=(0,n.useState)(""),[g,j]=(0,n.useState)(!1),[v,k]=(0,n.useState)({}),[b,y]=(0,n.useState)(!1),[w,S]=(0,n.useState)(1),D=(0,n.useCallback)(async()=>{try{console.log("Fetching all data from backend...");const[e,a,l,n]=await Promise.all([(0,t.Dy)(),(0,t.Xk)(),(0,t.ar)(),(0,t.Uc)()]);console.log("Received all data:",{workplacesCount:e.length,expertsCount:a.length,doctorsCount:l.length,dspsCount:n.length});const i=e.filter(e=>"onaylandi"===e.approvalStatus);console.log("Approved workplaces count:",i.length),s(i),o(a),m(l),p(n),console.log("State updated after data fetch")}catch(x){console.error("Error fetching data:",x),f("Veri al\u0131n\u0131rken hata olu\u015ftu")}},[]);(0,n.useEffect)(()=>{console.log("WorkplacePage useEffect running - fetching all data at:",(new Date).toISOString()),D()},[]),(0,n.useEffect)(()=>{console.log("Location changed to:",e.pathname,"at:",(new Date).toISOString()),D()},[e.pathname]),(0,n.useEffect)(()=>{const e=()=>{console.log("Window focused, refreshing all data..."),D()};return window.addEventListener("focus",e),()=>{window.removeEventListener("focus",e)}},[]);const C=()=>{setTimeout(()=>{N(""),f("")},3e3)},E=e=>{switch(e){case"low":return"Az Tehlikeli";case"dangerous":return"Tehlikeli";case"veryDangerous":return"\xc7ok Tehlikeli";default:return"Belirtilmemi\u015f"}},I=(e,a)=>{if(a&&a.Expert&&(console.log("Using included Expert data:",a.Expert),a.Expert.firstName&&a.Expert.lastName))return"".concat(a.Expert.firstName," ").concat(a.Expert.lastName);if(!e)return"Atanmam\u0131\u015f";const s=r.find(a=>a.id===parseInt(e));return s&&s.firstName&&s.lastName?"".concat(s.firstName," ").concat(s.lastName):"Bilinmeyen Uzman"},A=(e,a)=>{if(a&&a.Doctor&&(console.log("Using included Doctor data:",a.Doctor),a.Doctor.firstName&&a.Doctor.lastName))return"".concat(a.Doctor.firstName," ").concat(a.Doctor.lastName);if(!e)return"Atanmam\u0131\u015f";const s=d.find(a=>a.id===parseInt(e));return s&&s.firstName&&s.lastName?"".concat(s.firstName," ").concat(s.lastName):"Bilinmeyen Hekim"},z=(e,a)=>{if(a&&a.Dsp&&(console.log("Using included Dsp data:",a.Dsp),a.Dsp.firstName&&a.Dsp.lastName))return"".concat(a.Dsp.firstName," ").concat(a.Dsp.lastName);if(!e)return"Atanmam\u0131\u015f";const s=h.find(a=>a.id===parseInt(e));return s&&s.firstName&&s.lastName?"".concat(s.firstName," ").concat(s.lastName):"Bilinmeyen DSP"},O=e=>{const{name:a,value:s}=e.target;k(e=>(0,l.A)((0,l.A)({},e),{},{[a]:s}))},P=()=>{y(!1)},U=()=>{j(!1),k({}),document.body.style.overflow="auto"},L=10*w,T=L-10,K=a.slice(T,L),B=Math.ceil(a.length/10),R=e=>{S(e)};return(0,c.jsxs)("div",{className:"workplace-page-container",children:[u&&(0,c.jsx)("div",{className:"popup-notification alert alert-info",children:u}),x&&(0,c.jsx)("div",{className:"popup-notification alert alert-warning",children:x}),b&&(0,c.jsx)("div",{className:"popup-overlay",onClick:P,children:(0,c.jsxs)("div",{className:"popup-content",onClick:e=>e.stopPropagation(),children:[(0,c.jsxs)("div",{className:"popup-header",children:[(0,c.jsx)("h3",{children:"Kay\u0131t Silme Onay\u0131"}),(0,c.jsx)("button",{className:"popup-close",onClick:P,children:"\xd7"})]}),(0,c.jsx)("div",{className:"popup-body",children:(0,c.jsx)("p",{children:"Kay\u0131d\u0131 ger\xe7ekten silmek istiyor musunuz?"})}),(0,c.jsxs)("div",{className:"popup-footer",children:[(0,c.jsx)("button",{className:"btn btn-secondary",onClick:P,children:"\u0130ptal"}),(0,c.jsx)("button",{className:"btn btn-danger",onClick:async()=>{try{v.id?(await(0,t.QW)(v.id),N("\u0130\u015f yeri ba\u015far\u0131yla silindi!"),y(!1),U(),await D(),C()):(y(!1),U())}catch(x){console.error("Error deleting workplace:",x),x.message?f("\u0130\u015f yeri silinirken hata olu\u015ftu: ".concat(x.message)):f("\u0130\u015f yeri silinirken hata olu\u015ftu"),C()}},children:"Sil"})]})]})}),(0,c.jsx)("div",{className:"workplace-page-content",children:(0,c.jsxs)("div",{className:"workplaces-container",children:[(0,c.jsxs)("div",{className:"header-row",children:[(0,c.jsx)("div",{className:"header-cell",children:"\u0130\u015f Yeri Ad\u0131"}),(0,c.jsx)("div",{className:"header-cell",children:"Sicil No"}),(0,c.jsx)("div",{className:"header-cell",children:"Tehlike S\u0131n\u0131f\u0131"}),(0,c.jsx)("div",{className:"header-cell",children:"Atanan Uzman"}),(0,c.jsx)("div",{className:"header-cell",children:"Atanan Hekim"}),(0,c.jsx)("div",{className:"header-cell",children:"Atanan DSP"})]}),(0,c.jsxs)("div",{className:"workplaces-list",children:[K.map(e=>(0,c.jsxs)("div",{className:"workplace-row",onClick:()=>(e=>{k(e),j(!0),document.body.style.overflow="hidden"})(e),children:[(0,c.jsx)("div",{className:"workplace-cell",children:e.name}),(0,c.jsx)("div",{className:"workplace-cell",children:e.sskRegistrationNo}),(0,c.jsx)("div",{className:"workplace-cell",children:E(e.riskLevel)}),(0,c.jsx)("div",{className:"workplace-cell",children:I(e.assignedExpertId,e)}),(0,c.jsx)("div",{className:"workplace-cell",children:A(e.assignedDoctorId,e)}),(0,c.jsx)("div",{className:"workplace-cell",children:z(e.assignedDspId,e)})]},e.id)),0===a.length&&(0,c.jsx)("div",{className:"no-workplaces",children:"Onaylanm\u0131\u015f i\u015f yeri bulunmamaktad\u0131r."})]}),B>1&&(0,c.jsxs)("div",{className:"pagination",children:[(0,c.jsx)("button",{className:"pagination-button",onClick:()=>R(w>1?w-1:1),disabled:1===w,children:"\xd6nceki"}),(0,c.jsxs)("span",{className:"pagination-info",children:["Sayfa ",w," / ",B]}),(0,c.jsx)("button",{className:"pagination-button",onClick:()=>R(w<B?w+1:B),disabled:w===B,children:"Sonraki"})]})]})}),g&&(0,c.jsx)("div",{className:"modal-overlay",onClick:U,children:(0,c.jsxs)("div",{className:"modal-content",onClick:e=>e.stopPropagation(),children:[(0,c.jsxs)("div",{className:"modal-header",children:[(0,c.jsx)("h3",{children:"Kay\u0131tl\u0131 Uzman Kart\u0131"}),(0,c.jsx)("button",{className:"modal-close",onClick:U,children:"\xd7"})]}),(0,c.jsx)("div",{className:"modal-body",children:(0,c.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{if(v.id){const e=(0,l.A)((0,l.A)({},v),{},{assignedExpertId:v.assignedExpertId||null,assignedDoctorId:v.assignedDoctorId||null,assignedDspId:v.assignedDspId||null});await(0,t.O0)(v.id,e);N("\u0130\u015f yeri ba\u015far\u0131yla g\xfcncellendi!"),j(!1),await D(),C()}}catch(x){console.error("Error updating workplace:",x),x.message?f("\u0130\u015f yeri g\xfcncellenirken hata olu\u015ftu: ".concat(x.message)):f("\u0130\u015f yeri g\xfcncellenirken hata olu\u015ftu"),C()}},children:[(0,c.jsxs)("div",{className:"form-row",children:[(0,c.jsx)("div",{className:"form-col",children:(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{className:"form-label",children:"\u0130\u015f Yeri Ad\u0131:"}),(0,c.jsx)("input",{type:"text",name:"name",value:v.name||"",onChange:O,className:"form-input",readOnly:!0})]})}),(0,c.jsx)("div",{className:"form-col",children:(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{className:"form-label",children:"SGK \u0130\u015fyeri Sicil No:"}),(0,c.jsx)("input",{type:"text",name:"sskRegistrationNo",value:v.sskRegistrationNo||"",onChange:O,className:"form-input",readOnly:!0})]})})]}),(0,c.jsx)("div",{className:"form-row",children:(0,c.jsx)("div",{className:"form-col",children:(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{className:"form-label",children:"Tehlike S\u0131n\u0131f\u0131:"}),(0,c.jsx)("input",{type:"text",name:"riskLevel",value:v.riskLevel?E(v.riskLevel):"",onChange:O,className:"form-input",readOnly:!0})]})})}),(0,c.jsxs)("div",{className:"form-row",children:[(0,c.jsx)("div",{className:"form-col",children:(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{className:"form-label",children:"Atanan Uzman:"}),(0,c.jsxs)("select",{name:"assignedExpertId",value:v.assignedExpertId||"",onChange:O,className:"form-select",children:[(0,c.jsx)("option",{value:"",children:"Se\xe7iniz"}),r.map(e=>(0,c.jsxs)("option",{value:e.id,children:[e.firstName," ",e.lastName]},e.id))]})]})}),(0,c.jsx)("div",{className:"form-col",children:(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{className:"form-label",children:"Atanan Hekim:"}),(0,c.jsxs)("select",{name:"assignedDoctorId",value:v.assignedDoctorId||"",onChange:O,className:"form-select",children:[(0,c.jsx)("option",{value:"",children:"Se\xe7iniz"}),d.map(e=>(0,c.jsxs)("option",{value:e.id,children:[e.firstName," ",e.lastName]},e.id))]})]})})]}),(0,c.jsx)("div",{className:"form-row",children:(0,c.jsx)("div",{className:"form-col",children:(0,c.jsxs)("div",{className:"form-group",children:[(0,c.jsx)("label",{className:"form-label",children:"Atanan DSP:"}),(0,c.jsxs)("select",{name:"assignedDspId",value:v.assignedDspId||"",onChange:O,className:"form-select",children:[(0,c.jsx)("option",{value:"",children:"Se\xe7iniz"}),h.map(e=>(0,c.jsxs)("option",{value:e.id,children:[e.firstName," ",e.lastName]},e.id))]})]})})}),(0,c.jsxs)("div",{className:"modal-actions",children:[(0,c.jsx)("button",{type:"button",className:"btn btn-danger",onClick:()=>{y(!0)},children:"Sil"}),(0,c.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:U,children:"\u0130ptal"}),(0,c.jsx)("button",{type:"submit",className:"btn btn-primary",children:"G\xfcncelle"})]})]})})]})})]})}}}]);
//# sourceMappingURL=579.148fd289.chunk.js.map