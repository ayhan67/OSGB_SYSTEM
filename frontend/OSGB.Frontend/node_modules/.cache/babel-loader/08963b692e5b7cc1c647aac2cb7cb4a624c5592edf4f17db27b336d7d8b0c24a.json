{"ast":null,"code":"import React,{useState}from'react';import{createWorkplace,getAllWorkplaces}from'../services/api';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const DashboardTest=()=>{const[workplaces,setWorkplaces]=useState([]);const[testStatus,setTestStatus]=useState('Not started');const[testWorkplaceId,setTestWorkplaceId]=useState(null);// Function to simulate the user workflow\nconst runTest=async()=>{try{setTestStatus('Starting test...');// 1. Get initial workplaces count\nsetTestStatus('1. Getting initial workplaces...');const initialWorkplaces=await getAllWorkplaces();const initialCount=initialWorkplaces.length;console.log('Initial workplaces count:',initialCount);// 2. Create a new workplace\nsetTestStatus('2. Creating test workplace...');const newWorkplace=await createWorkplace({name:'Test Workplace for Navigation Issue',address:'Test Address',sskRegistrationNo:'1234567890',taxOffice:'Test Tax Office',taxNumber:'1234567890',price:1000,riskLevel:'low',employeeCount:10,source:'Test Source',approvalStatus:'atama'});setTestWorkplaceId(newWorkplace.id);console.log('Created workplace with ID:',newWorkplace.id);// 3. Get workplaces after creation\nsetTestStatus('3. Getting workplaces after creation...');const workplacesAfterCreation=await getAllWorkplaces();const countAfterCreation=workplacesAfterCreation.length;console.log('Workplaces count after creation:',countAfterCreation);const createdWorkplaceFound=workplacesAfterCreation.find(w=>w.id===newWorkplace.id);if(createdWorkplaceFound){setTestStatus('✓ Test workplace found after creation');console.log('Test workplace found after creation:',createdWorkplaceFound.name);}else{setTestStatus('✗ ERROR: Test workplace NOT found after creation');console.log('ERROR: Test workplace NOT found after creation');console.log('All workplaces:',workplacesAfterCreation.map(w=>({id:w.id,name:w.name})));return;}// 4. Simulate \"navigation away\" by clearing state\nsetTestStatus('4. Simulating navigation away...');setWorkplaces([]);await new Promise(resolve=>setTimeout(resolve,1000));// Wait 1 second\n// 5. Simulate \"navigation back\" by fetching data again\nsetTestStatus('5. Simulating navigation back...');const workplacesAfterNavigation=await getAllWorkplaces();const countAfterNavigation=workplacesAfterNavigation.length;console.log('Workplaces count after navigation:',countAfterNavigation);const workplaceAfterNavigation=workplacesAfterNavigation.find(w=>w.id===newWorkplace.id);if(workplaceAfterNavigation){setTestStatus('✓ SUCCESS: Test workplace still found after navigation');console.log('SUCCESS: Test workplace still found after navigation:',workplaceAfterNavigation.name);setWorkplaces(workplacesAfterNavigation);}else{setTestStatus('✗ FAILURE: Test workplace disappeared after navigation');console.log('FAILURE: Test workplace disappeared after navigation');console.log('All workplaces after navigation:',workplacesAfterNavigation.map(w=>({id:w.id,name:w.name})));setWorkplaces(workplacesAfterNavigation);return;}// 6. Clean up\nsetTestStatus('6. Cleaning up test workplace...');// In a real test, we would delete the workplace here\n// But for this simulation, we'll just report success\nsetTestStatus('✓ TEST COMPLETED SUCCESSFULLY');}catch(error){console.error('Test error:',error);setTestStatus('✗ TEST FAILED: '+error.message);}};return/*#__PURE__*/_jsxs(\"div\",{style:{padding:'20px',fontFamily:'Arial, sans-serif'},children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Dashboard Navigation Test\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Status: \",testStatus]}),/*#__PURE__*/_jsx(\"button\",{onClick:runTest,style:{padding:'10px 20px',fontSize:'16px'},children:\"Run Navigation Test\"}),workplaces.length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'20px'},children:[/*#__PURE__*/_jsxs(\"h3\",{children:[\"Current Workplaces (\",workplaces.length,\"):\"]}),/*#__PURE__*/_jsx(\"ul\",{children:workplaces.map(workplace=>/*#__PURE__*/_jsxs(\"li\",{children:[workplace.name,\" (ID: \",workplace.id,\")\",testWorkplaceId===workplace.id&&' ← TEST WORKPLACE']},workplace.id))})]})]});};export default DashboardTest;","map":{"version":3,"names":["React","useState","createWorkplace","getAllWorkplaces","jsx","_jsx","jsxs","_jsxs","DashboardTest","workplaces","setWorkplaces","testStatus","setTestStatus","testWorkplaceId","setTestWorkplaceId","runTest","initialWorkplaces","initialCount","length","console","log","newWorkplace","name","address","sskRegistrationNo","taxOffice","taxNumber","price","riskLevel","employeeCount","source","approvalStatus","id","workplacesAfterCreation","countAfterCreation","createdWorkplaceFound","find","w","map","Promise","resolve","setTimeout","workplacesAfterNavigation","countAfterNavigation","workplaceAfterNavigation","error","message","style","padding","fontFamily","children","onClick","fontSize","marginTop","workplace"],"sources":["C:/Users/USER/OneDrive/Desktop/YAZILIM/PRO/OSGB_System/frontend/OSGB.Frontend/src/components/DashboardTest.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { createWorkplace, getAllWorkplaces } from '../services/api';\r\n\r\ninterface Workplace {\r\n  id: number;\r\n  name: string;\r\n  address: string;\r\n  sskRegistrationNo: string;\r\n  taxOffice: string;\r\n  taxNumber: string;\r\n  price: string;\r\n  riskLevel: string;\r\n  employeeCount: string;\r\n  source: string;\r\n  assignedExpertId: string;\r\n  assignedDoctorId: string;\r\n  assignedDspId: string;\r\n  registrationDate: string;\r\n  approvalStatus: string;\r\n}\r\n\r\nconst DashboardTest: React.FC = () => {\r\n  const [workplaces, setWorkplaces] = useState<Workplace[]>([]);\r\n  const [testStatus, setTestStatus] = useState<string>('Not started');\r\n  const [testWorkplaceId, setTestWorkplaceId] = useState<number | null>(null);\r\n\r\n  // Function to simulate the user workflow\r\n  const runTest = async () => {\r\n    try {\r\n      setTestStatus('Starting test...');\r\n      \r\n      // 1. Get initial workplaces count\r\n      setTestStatus('1. Getting initial workplaces...');\r\n      const initialWorkplaces = await getAllWorkplaces();\r\n      const initialCount = initialWorkplaces.length;\r\n      console.log('Initial workplaces count:', initialCount);\r\n      \r\n      // 2. Create a new workplace\r\n      setTestStatus('2. Creating test workplace...');\r\n      const newWorkplace = await createWorkplace({\r\n        name: 'Test Workplace for Navigation Issue',\r\n        address: 'Test Address',\r\n        sskRegistrationNo: '1234567890',\r\n        taxOffice: 'Test Tax Office',\r\n        taxNumber: '1234567890',\r\n        price: 1000,\r\n        riskLevel: 'low',\r\n        employeeCount: 10,\r\n        source: 'Test Source',\r\n        approvalStatus: 'atama'\r\n      });\r\n      \r\n      setTestWorkplaceId(newWorkplace.id);\r\n      console.log('Created workplace with ID:', newWorkplace.id);\r\n      \r\n      // 3. Get workplaces after creation\r\n      setTestStatus('3. Getting workplaces after creation...');\r\n      const workplacesAfterCreation = await getAllWorkplaces();\r\n      const countAfterCreation = workplacesAfterCreation.length;\r\n      console.log('Workplaces count after creation:', countAfterCreation);\r\n      \r\n      const createdWorkplaceFound = workplacesAfterCreation.find((w: Workplace) => w.id === newWorkplace.id);\r\n      if (createdWorkplaceFound) {\r\n        setTestStatus('✓ Test workplace found after creation');\r\n        console.log('Test workplace found after creation:', createdWorkplaceFound.name);\r\n      } else {\r\n        setTestStatus('✗ ERROR: Test workplace NOT found after creation');\r\n        console.log('ERROR: Test workplace NOT found after creation');\r\n        console.log('All workplaces:', workplacesAfterCreation.map((w: Workplace) => ({id: w.id, name: w.name})));\r\n        return;\r\n      }\r\n      \r\n      // 4. Simulate \"navigation away\" by clearing state\r\n      setTestStatus('4. Simulating navigation away...');\r\n      setWorkplaces([]);\r\n      await new Promise(resolve => setTimeout(resolve, 1000)); // Wait 1 second\r\n      \r\n      // 5. Simulate \"navigation back\" by fetching data again\r\n      setTestStatus('5. Simulating navigation back...');\r\n      const workplacesAfterNavigation = await getAllWorkplaces();\r\n      const countAfterNavigation = workplacesAfterNavigation.length;\r\n      console.log('Workplaces count after navigation:', countAfterNavigation);\r\n      \r\n      const workplaceAfterNavigation = workplacesAfterNavigation.find((w: Workplace) => w.id === newWorkplace.id);\r\n      if (workplaceAfterNavigation) {\r\n        setTestStatus('✓ SUCCESS: Test workplace still found after navigation');\r\n        console.log('SUCCESS: Test workplace still found after navigation:', workplaceAfterNavigation.name);\r\n        setWorkplaces(workplacesAfterNavigation);\r\n      } else {\r\n        setTestStatus('✗ FAILURE: Test workplace disappeared after navigation');\r\n        console.log('FAILURE: Test workplace disappeared after navigation');\r\n        console.log('All workplaces after navigation:', workplacesAfterNavigation.map((w: Workplace) => ({id: w.id, name: w.name})));\r\n        setWorkplaces(workplacesAfterNavigation);\r\n        return;\r\n      }\r\n      \r\n      // 6. Clean up\r\n      setTestStatus('6. Cleaning up test workplace...');\r\n      // In a real test, we would delete the workplace here\r\n      // But for this simulation, we'll just report success\r\n      setTestStatus('✓ TEST COMPLETED SUCCESSFULLY');\r\n      \r\n    } catch (error) {\r\n      console.error('Test error:', error);\r\n      setTestStatus('✗ TEST FAILED: ' + (error as Error).message);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div style={{ padding: '20px', fontFamily: 'Arial, sans-serif' }}>\r\n      <h2>Dashboard Navigation Test</h2>\r\n      <p>Status: {testStatus}</p>\r\n      <button onClick={runTest} style={{ padding: '10px 20px', fontSize: '16px' }}>\r\n        Run Navigation Test\r\n      </button>\r\n      \r\n      {workplaces.length > 0 && (\r\n        <div style={{ marginTop: '20px' }}>\r\n          <h3>Current Workplaces ({workplaces.length}):</h3>\r\n          <ul>\r\n            {workplaces.map((workplace: Workplace) => (\r\n              <li key={workplace.id}>\r\n                {workplace.name} (ID: {workplace.id})\r\n                {testWorkplaceId === workplace.id && ' ← TEST WORKPLACE'}\r\n              </li>\r\n            ))}\r\n          </ul>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default DashboardTest;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}